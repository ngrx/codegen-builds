!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("fs"),require("path"),require("typescript"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","fs","path","typescript","lodash"],n):n((e.ngrx=e.ngrx||{},e.ngrx.codegen={}),e.fs,e.path,e.typescript,e.lodash)}(this,function(e,n,t,r,i){"use strict";function o(e){return e.filter(function(e){return e.questionToken}).map(function(e){return{name:e.name.getText(),required:!1}})}function u(e){return e.members.filter(r.isPropertySignature)}function a(e){return e.filter(function(e){return!e.questionToken}).map(function(e){return{name:e.name.getText(),required:!0}}).filter(function(e){return"type"!==e.name})}function c(e){var n=u(e).find(function(e){return"type"===e.name.getText()});if(n)return r.isLiteralTypeNode(n.type)?n.type:void 0}function f(e){var n=e.heritageClauses;return!!n&&n.some(function(e){return e.types.some(function(e){return"Action"===e.expression.getText()})})}function s(e){return 0!=(r.getCombinedModifierFlags(e)&r.ModifierFlags.Export)}function p(e){return!!e.parent&&e.parent.kind===r.SyntaxKind.SourceFile}function l(e){return s(e)&&p(e)}function d(e){var n=K.exec(e);if(null===n)throw new Error('Could not parse action type "'+e+'"');return{category:n[1],name:n[2]}}function m(e){return r.createFunctionDeclaration(void 0,[r.createToken(r.SyntaxKind.ExportKeyword)],void 0,R(e),void 0,e.properties.map(function(n){var t=n.name,i=n.required;return r.createParameter(void 0,void 0,void 0,t,i?void 0:r.createToken(r.SyntaxKind.QuestionToken),r.createTypeReferenceNode(P(e)+'["'+t+'"]',void 0),void 0)}),r.createTypeReferenceNode(P(e),void 0),r.createBlock([r.createReturn(r.createObjectLiteral([r.createPropertyAssignment("type",r.createPropertyAccess(r.createIdentifier(I(e)),r.createIdentifier(C(e))))].concat(e.properties.map(function(e){var n=e.name;return r.createShorthandPropertyAssignment(n,void 0)}))))],!0))}function y(e){var n=e[0];return r.createEnumDeclaration(void 0,[r.createToken(r.SyntaxKind.ExportKeyword)],I(n),e.map(function(e){return{prop:C(e),value:N(e)}}).map(function(e){var n=e.prop,t=e.value;return r.createEnumMember(n,r.createLiteral(t))}))}function v(e,n){return r.createImportDeclaration(void 0,void 0,r.createImportClause(void 0,r.createNamedImports(n.map(P).map(function(e){return r.createImportSpecifier(void 0,r.createIdentifier(e))}))),r.createIdentifier("'./"+e+"'"))}function h(e){var n=e[0];return r.createTypeAliasDeclaration(void 0,[r.createToken(r.SyntaxKind.ExportKeyword)],D(n),void 0,r.createTypeLiteralNode(e.map(function(e){return r.createPropertySignature(void 0,JSON.stringify(N(e)),void 0,r.createTypeReferenceNode(P(e),void 0),void 0)})))}function g(e){var n=e[0];return r.createTypeAliasDeclaration(void 0,[r.createToken(r.SyntaxKind.ExportKeyword)],L(n),void 0,r.createUnionTypeNode(e.map(P).map(function(e){return r.createTypeReferenceNode(e,void 0)})))}function w(e,n){var t=n.statements.filter(r.isInterfaceDeclaration).filter(l).filter(f).filter(function(e){return!!c(e)}).map(function(e){return{name:e.name.getText(),actionType:i.trim(c(e).literal.getFullText()," '\"`"),properties:a(u(e)).concat(o(u(e)))}});return t.length,[v(e,t),y(t),g(t),h(t)].concat(t.map(function(e){return m(e)}))}function x(e){var n=r.createSourceFile("","",r.ScriptTarget.ES2015,!1,r.ScriptKind.TS),t=r.createPrinter({newLine:r.NewLineKind.LineFeed});return e.map(function(e){return t.printNode(r.EmitHint.Unspecified,e,n)}).join("\n\n")}function T(e){return new Promise(function(n,t){j(e,{cwd:process.cwd(),ignore:["**/node_modules/**"]},function(e,r){if(e)return t(e);n(r)})})}function b(e){return M(this,void 0,void 0,function(){return F(this,function(t){return[2,new Promise(function(t,r){n.readFile(e,"utf8",function(e,n){e?r(e):t(n)})})]})})}function S(e,t){return M(this,void 0,void 0,function(){return F(this,function(r){return[2,new Promise(function(r,i){n.writeFile(e,t,{encoding:"utf8"},function(e){e?i(e):r()})})]})})}function k(e){return r.createSourceFile("",e,r.ScriptTarget.ES2015,!0)}function E(e){return M(this,void 0,void 0,function(){var n,r,i,o,u,a,c,f,s,p,l,d,m;return F(this,function(y){switch(y.label){case 0:return n=O('Searching for files matching "'+e+'"').start(),[4,T(e)];case 1:r=y.sent(),n.succeed("Found "+r.length+' files for pattern "'+e+'"'),i=0,o=r,y.label=2;case 2:if(!(i<o.length))return[3,8];u=o[i],a=O(u).start(),y.label=3;case 3:return y.trys.push([3,6,,7]),c=t.parse(u),[4,b(u)];case 4:if(f=y.sent(),s=k(f),!(p=w(c.name,s)))throw new Error('No actions found for file "'+u+'"');return l=x(p),d=t.resolve(c.dir,"./"+c.name+".helpers.ts"),[4,S(d,l)];case 5:return y.sent(),a.succeed("Found "+p.length+" actions in "+u),[3,7];case 6:return m=y.sent(),a.fail(m.message),[3,7];case 7:return i++,[3,2];case 8:return[2]}})})}var F=function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(u=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(u=u.call(o,t[1])).done)return u;switch(o=0,u&&(t=[0,u.value]),t[0]){case 0:case 1:u=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(u=c.trys,!(u=u.length>0&&u[u.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!u||t[1]>u[0]&&t[1]<u[3])){c.label=t[1];break}if(6===t[0]&&c.label<u[1]){c.label=u[1],u=t;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(t);break}u[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=u=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,u,a,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return a={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},K=new RegExp(/\[(.*?)\](.*)/),N=function(e){return e.actionType},P=function(e){return e.name},q=i.flow(N,d,function(e){return e.category}),A=i.flow(q,i.camelCase,i.upperFirst),I=i.flow(A,function(e){return e+"ActionType"}),C=i.flow(P,i.snakeCase,function(e){return e.toUpperCase()}),L=i.flow(A,function(e){return e+"Actions"}),D=i.flow(A,function(e){return e+"ActionLookup"}),R=i.flow(P,i.camelCase,i.upperFirst,function(e){return"create"+e}),j=require("glob"),M=function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function u(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new t(function(n){n(e.value)}).then(u,a)}c((r=r.apply(e,n||[])).next())})},O=require("ora");e.codegen=E,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=./dist/codegen/bundles/codegen.umd.min.js.map